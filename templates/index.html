<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>📡 6사보도 서비스 내역</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "",
      authDomain: "sabodo-82fa8.firebaseapp.com",
      projectId: "sabodo-82fa8",
      storageBucket: "sabodo-82fa8.firebasestorage.app",
      messagingSenderId: "411843694800",
      appId: "1:411843694800:web:94e40d6ec9f05cdd60ced5",
      measurementId: "G-CKBERJMFMG"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const tableRef = db.collection("logTable");
    const alarmRef = db.collection("system").doc("alarmStatus"); // Firestore에서 알람 상태를 관리

    // 로그인 상태 확인 함수
    function checkLogin() {
      const currentUser = localStorage.getItem("username");
      if (currentUser) {
        document.getElementById("login-container").style.display = "none";
        document.getElementById("service-container").style.display = "block";
        document.getElementById("currentUser").innerText = `${currentUser} 님, 환영합니다! 이 페이지는 엘지유플러스에서 관리중입니다. 문의 : 02-2089-0610`;  // 로그인한 계정 표시
        loadTable();
        listenToAlarmStatus(); // 알람 상태 리스너 시작
      } else {
        document.getElementById("login-container").style.display = "block";
        document.getElementById("service-container").style.display = "none";
      }
    }

function deleteAllhides() {
  tableRef
    .orderBy("createdAt", "desc")
    .get()
    .then(snapshot => {
      const docs = snapshot.docs;

      const hidePromises = [];
      for (let i = 0; i < docs.length; i++) {
        const data = docs[i].data();
        
        // 고정 행 내용과 같은 경우 제외
        if (data.content === "🛠 이곳에 내용을 입력하시면 날짜와 시간은 자동으로 입력됩니다.(첫 행은 고정으로 사용하겠습니다.)") {
          continue; // 고정 행은 숨기지 않음
        }

        hidePromises.push(docs[i].ref.update({ hidden: true }));
      }

      Promise.all(hidePromises).then(() => {
        loadTable();
        alert("모든 행을 숨겼습니다 (고정 행은 유지됩니다).");
      });
    });
}

function toggleBroadcastStatus(button) {
  const tr = button.closest("tr");
  const rowId = tr.getAttribute("data-row-id");
  const current = button.innerText;

  let nextState, color;
  if (current === "송출전") {
    nextState = "송출중";
    color = "#ffcccc";  // 연빨강
  } else if (current === "송출중") {
    nextState = "송출후";
    color = "#dcdcdc";  // 회색
  } else {
    nextState = "송출전";
    color = "#fffbe6";  // 연노랑
  }

  // 버튼 텍스트 및 행 색상 변경
  button.innerText = nextState;
  tr.style.backgroundColor = color;

  // Firestore에 상태 업데이트
  if (rowId) {
    tableRef.doc(rowId).update({
      broadcastStatus: nextState
    });
  }
}


	  
function deleteAllRows() {
  if (!confirm("정말 모든 행을 완전히 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.")) return;

  tableRef.get().then(snapshot => {
    const deletePromises = [];
    snapshot.forEach(doc => {
      const data = doc.data();

      // ✅ 고정행은 삭제하지 않음
      if (data.content === "🛠 이곳에 내용을 입력하시면 날짜와 시간은 자동으로 입력됩니다.(첫 행은 고정으로 사용하겠습니다.)") {
        return; // 삭제 제외
      }

      deletePromises.push(doc.ref.delete());
    });

    return Promise.all(deletePromises);
  }).then(() => {
    alert("모든 행이 완전히 삭제되었습니다 (고정 행 제외).");
    loadTable();
  }).catch(error => {
    console.error("삭제 오류:", error);
    alert("삭제 중 오류가 발생했습니다.");
  });
}



  // 건수 보기 함수
  function openAllView() {
    window.open("allview.html", "_blank", "width=1200,height=800");
  }

// 전체 보기 함수
function openAllRows() {
    // hidden 여부에 관계없이 전체 로우 보여주기
    tableRef
      .orderBy('createdAt', 'desc')
      .get()
      .then(snapshot => {
        const tbody = document.getElementById("tableBody");
        tbody.innerHTML = "";
        const docs = snapshot.docs;
        const total = docs.length;

        docs.forEach((doc, index) => {
          const data = doc.data();
          const rowId = doc.id;
          const tr = document.createElement("tr");
          tr.setAttribute("data-row-id", rowId);
          tr.innerHTML = `
            <td>${total - index}</td>
	    <td><input type="checkbox" data-id="${rowId}" /></td>
            <td>${data.date || ''}</td>
            <td>${data.time || ''}</td>
            <td>${data.content || ''}</td>
            <td>${data.sender || ''}</td>
            <td colspan="6">숨김 여부: ${data.hidden ? '✅ 숨김' : '❌ 표시중'}</td>
          `;
          tbody.appendChild(tr);
        });
      });
	document.getElementById("viewStatus").innerText = "📋 현재 보기: 전체 행 보기";

  }

function downloadAsExcel() {
  const table = document.getElementById("logTable");
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.table_to_sheet(table);
  XLSX.utils.book_append_sheet(wb, ws, "6사보도망");

  // ✅ 오늘 날짜 구하기 (YYYY-MM-DD 형식)
  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = String(now.getMonth() + 1).padStart(2, '0');
  const dd = String(now.getDate()).padStart(2, '0');
  const todayStr = `${yyyy}-${mm}-${dd}`;

  // ✅ 파일명에 날짜 추가
  XLSX.writeFile(wb, `6사보도망_서비스내역_${todayStr}.xlsx`);
}


    // 로그인 함수
    function login() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const validUsers = {
        "lgu+": "lgu+",
        "kbs": "kbs",
        "mbc": "mbc",
        "sbs": "sbs",
        "ytn": "ytn",
        "mbn": "mbn",
        "obs": "obs"
      };

      if (validUsers[username] && validUsers[username] === password) {
        localStorage.setItem("username", username);
        checkLogin();
      } else {
        document.getElementById("error-message").innerText = "아이디나 비밀번호가 틀렸습니다.";
      }
    }


    // 로그아웃 함수
    function logout() {
      localStorage.removeItem("username");
      checkLogin();
    }

    /**
 * 내용 셀 수정 후 호출됩니다.
 * @param {string} id    - Firestore 문서 ID
 * @param {string} text  - 입력된 내용
 */
function onContentChange(id, text) {
  // 내용이 비어있으면 아무 것도 안 함
  if (!text.trim()) return;

  const now = new Date();
  // YYYY-MM-DD 포맷
  const date = [
    now.getFullYear(),
    String(now.getMonth() + 1).padStart(2, '0'),
    String(now.getDate()).padStart(2, '0')
  ].join('-');
  // HH:MM:SS 포맷
  const time = [
    String(now.getHours()).padStart(2, '0'),
    String(now.getMinutes()).padStart(2, '0'),
    String(now.getSeconds()).padStart(2, '0')
  ].join(':');

  // Firestore에 한꺼번에 업데이트
  tableRef.doc(id).update({
    content: text,
    date: date,
    time: time
  }).then(() => {
    loadTable();  // UI 새로고침
  });
}


    
    // 알람 상태 리스너
    function listenToAlarmStatus() {
      alarmRef.onSnapshot(doc => {
        const alarmStatus = doc.data();
        if (alarmStatus && alarmStatus.isAlarmActive) {
          document.getElementById("alarmSound").play(); // 알람 울리기
        } else {
          document.getElementById("alarmSound").pause(); // 알람 정지
          document.getElementById("alarmSound").currentTime = 0;
        }
      });
    }

    // 알람 시작 함수
    function sendAlarm() {
      alarmRef.set({isAlarmActive: true}).then(() => {
        console.log("알람이 울렸습니다.");
      });
    }

    // 알람 정지 함수
    function stopAlarm() {
      alarmRef.set({isAlarmActive: false}).then(() => {
        console.log("알람이 정지되었습니다.");
      });
    }

    // 데이터 로드 함수
    function loadTable() {
      const dateCounts = {}; // 이 줄을 loadTable() 함수 맨 위에 추가
      const currentUser = localStorage.getItem("username"); // 로그인된 사용자
      const receivers = ["KBS", "MBC", "SBS", "MBN", "YTN", "OBS"];

	tableRef
    	.orderBy('createdAt','desc')   // 생성된 순서(오래된 것부터)로 정렬
  	  .get()
  	  .then(snapshot => {
	const docs = snapshot.docs.filter(doc => !doc.data().hidden); // hidden이 true인 문서 제외
        const tbody = document.getElementById("tableBody");
        tbody.innerHTML = ""; // 테이블 초기화

    const total = docs.length;  // ✅ 수정: 전체 문서 수가 아닌 필터링된 문서 수로
    docs.forEach((doc, index) => {
      const data = doc.data();
      const rowId = doc.id;

          const tr = document.createElement("tr");
          tr.setAttribute("data-row-id", rowId);  // 행 ID를 data-row-id로 설정

	// ✅ 상태에 따라 배경색 지정
	const status = data.broadcastStatus || "송출전";
	let bgColor = "#fffbe6"; // 기본 송출전
	if (status === "송출중") bgColor = "#ffcccc";
	else if (status === "송출후") bgColor = "#dcdcdc";
	tr.style.backgroundColor = bgColor;


          // 수신사별로 제외 상태를 체크하여, 해당 수신사에서 제외된 행만 숨김
          let shouldDisplayRow = true;

          receivers.forEach((name, idx) => {
            // 로그인된 계정이 해당 수신사일 경우, 대소문자 구분 없이 비교
            if (currentUser.toUpperCase() === name.toUpperCase() && data[name] && data[name].exclude === "미수신") {
              shouldDisplayRow = false;  // 해당 수신사에서 제외된 경우 해당 행을 숨기도록 설정
            }
          });

          // 행을 숨기지 않도록 설정
          if (!shouldDisplayRow) {
            tr.style.display = "none";  // 해당 수신사에서 제외된 경우 해당 행을 숨김
          }

          tr.innerHTML = `
  	    <td>${total - index}</td>  <!-- ✅ 역순 번호 표시 -->
	    <td><input type="checkbox" data-id="${rowId}" /></td>
	    <td><button onclick="toggleBroadcastStatus(this)">${status}</button></td>
            <td contenteditable="true" onblur="updateCell('${doc.id}', 'date', this.innerText)">${data.date || ''}</td>
            <td contenteditable="true" onblur="updateCell('${doc.id}', 'time', this.innerText)">${data.time || ''}</td>
            <td contenteditable="true" onblur="onContentChange('${doc.id}', this.innerText)">${data.content || ''}</td>
		<td>
  		<select onchange="updateCell('${doc.id}', 'sender', this.value)">
   		 ${["선택","LGU+", "KBS", "MBC", "SBS", "YTN", "MBN", "OBS"].map(option => `
   		   <option value="${option}" ${data.sender === option ? 'selected' : ''}>${option}</option>
  		  `).join('')}
 		 </select>
		</td>

${receivers.map(rcv => `
  <td>
    <button class="logo-${rcv.toLowerCase()}" onclick="toggleAck('${doc.id}', '${rcv}')">
      ${(data[rcv] && data[rcv].ack) || '확인!'}
    </button>
  </td>
  <td>
    <button onclick="toggleExclude(this, '${doc.id}', '${rcv}')" 
            class="${(data[rcv] && data[rcv].exclude === '미수신') ? 'exclude-btn active' : 'exclude-btn'}">
      ${(data[rcv] && data[rcv].exclude) || '수신'}
    </button>
  </td>
`).join('')}

          `;
          tbody.appendChild(tr);
          // ⭐ 날짜별 건수 세기
          if (data.date) {
            if (dateCounts[data.date]) {
              dateCounts[data.date]++;
            } else {
              dateCounts[data.date] = 1;
            }
          }

        index++;  // ✅ 카운터 증가
        });
		  		  // 고정된 첫 행 추가
		const fixedRow = document.createElement("tr");
		fixedRow.innerHTML = `
		  <td>고정</td>
		  <td></td>
		  <td></td>
		  <td>2025-xx-xx</td>
		  <td>00:00:00</td>
		  <td>🛠 이곳에 내용을 입력하시면 날짜와 시간은 자동으로 입력됩니다.(첫 행은 고정으로 사용하겠습니다.)</td>
		  <td>LGU+</td>
		  <td colspan="12" style="color:blue;">수신사에서는 내용 확인 시 확인버튼을 눌러주세요.</td>
		`;
    		tbody.appendChild(fixedRow);
      });
	    document.getElementById("viewStatus").innerText = "📄 현재 보기: 기본 보기";
    }

    // 셀 업데이트 함수
    function updateCell(id, field, value) {
      tableRef.doc(id).update({[field]: value}).then(() => loadTable());
    }

    // 확인 상태 토글
    function toggleAck(id, rcv) {
      const cellRef = tableRef.doc(id);
      cellRef.get().then(doc => {
        const data = doc.data();
        const current = (data[rcv] && data[rcv].ack) || '확인!';
        const updated = current === '확인!' ? '✅ 확인됨' : '확인!';
        cellRef.update({[`${rcv}.ack`]: updated}).then(() => {
          loadTable();
        });
      });
    }

    // 제외 상태 토글 (해당 계정에만 적용)
    function toggleExclude(btn, id, rcv) {
      const currentUser = localStorage.getItem("username");
      const cellRef = tableRef.doc(id);

      // Firestore에서 해당 행의 데이터를 가져옴
      cellRef.get().then(doc => {
        const data = doc.data();

        // 현재 상태 가져오기
        const current = (data[rcv] && data[rcv].exclude) || '수신';

        // 새로운 제외 상태
        const updated = current === '수신' ? '미수신' : '수신';

        // 제외 상태를 Firestore에 업데이트 (현재 계정에 대해서만)
        cellRef.update({
          [`${rcv}.exclude`]: updated,
          [`${rcv}.ack`]: '확인!'  // 확인 상태 초기화
        }).then(() => {
          // 즉시 반영
          loadTable();

          // 버튼 색 변경: 빨간색으로 표시
          btn.classList.toggle('active');
        });
      });
    }

    // 행 추가 함수
    function addRow() {
      const rowData = {
        date: '', time: '', content: '', sender: '',
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
	hidden: false,  // ✅ 숨김 여부
  	broadcastStatus: "송출전",  // ✅ 버튼 상태 기본값
      };

      const receivers = ["KBS", "MBC", "SBS", "MBN", "YTN", "OBS"];
      receivers.forEach(rcv => {
        rowData[rcv] = {ack: '확인!', exclude: '수신'};
      });
      tableRef.add(rowData).then(() => {
        loadTable();
      });
    }

    function saveData() {
      alert("저장되었습니다!");
    }


    // 행 숨기기 함수
function deleteRow() {
  const checkedBoxes = document.querySelectorAll("#logTable tbody input[type='checkbox']:checked");
  const deletePromises = [];

  checkedBoxes.forEach(box => {
    const id = box.getAttribute("data-id");
    const row = box.closest("tr");
    const isFixedRow = row && row.innerText.includes("🛠 이곳에 내용을 입력하시면");

    if (!isFixedRow && id) {
      deletePromises.push(tableRef.doc(id).delete());
    }
  });

  Promise.all(deletePromises).then(() => {
    loadTable();
  });
}


    // 페이지 로딩 시 로그인 상태 확인
    document.addEventListener("DOMContentLoaded", checkLogin);

    // 새로고침 버튼 클릭 시 페이지 리프레시
    document.addEventListener("DOMContentLoaded", function () {
      const refreshButton = document.getElementById("refreshButton");
      if (refreshButton) {
        refreshButton.addEventListener("click", function () {
          window.location.reload(); // 페이지 리프레시
        });
      }
    });

    // 1분마다 자동으로 페이지 리프레시
    setInterval(function () {
      window.location.reload(); // 페이지 리프레시
    }, 300000); // 60000ms = 1분
  </script>
  <style>

    h1 {
      text-align: center;
    }

    .button-container {
      text-align: center;
      margin-bottom: 20px;
    }

    button {
      padding: 12px 24px;
      font-size: 16px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    .send,
    .stop,
    .add,
    .delete,
    .save,
    .refresh,
    .logout {
      background-color: #2196F3;
      color: white;
    }

    .send {
      background-color: #FF9800;
    }

    .stop {
      background-color: #f44336;
    }

    .add,
    .delete,
    .save {
      background-color: #4CAF50;
    }

    .exclude-btn.active {
      background-color: #f44336;
      color: white;
    }

    .exclude-btn {
      background-color: #2196F3;
      color: white;
    }

    /* 모든 테이블 버튼 크기 축소 */
#logTable td button {
  padding: 6px 12px;
  font-size: 1rem;
  line-height: 1.4;
  min-width: 0;          /* 최소 너비 제한 해제 */
}

    /* ‘내용’ 입력 칼럼(테이블 6번째 칼럼) 글자 크게 */
#logTable td:nth-child(6),
#logTable th:nth-child(6) {
  font-size: 1.2rem;    /* 원하시는 크기로 조정하세요 */
  line-height: 1.4;     /* 필요시 줄간격도 조절 */
}

    .logout {
      background-color: #9C27B0;
    }

    .login-container {
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .login-container input {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .login-container button {
      width: 100%;
      padding: 12px;
      background-color: #2196F3;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .login-container button:hover {
      background-color: #1976D2;
    }

    .error-message {
      color: red;
      margin-top: 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: center;
    }

    thead th {
      background-color: #f2f2f2;
      font-weight: bold;
    }


    td[contenteditable] {
      border: 1px solid #ccc;
    }

    .receiver-row {
      text-align: center;
      font-weight: bold;
      background-color: #f2f2f2;
    }
  </style>
 <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
  <!-- 로그인 페이지 -->
  <div id="login-container" class="login-container">
    <h2>📡 6사보도망 로그인</h2>
    <input type="text" id="username" placeholder="아이디" required />
    <input type="password" id="password" placeholder="비밀번호" required />
    <button onclick="login()">로그인</button>
    <div class="error-message" id="error-message"></div> <!-- 오류 메시지 표시 -->
  </div>


  <style>

	/* 페이지 전반 배경을 옅은 분홍색으로 설정 */
	body {
	  font-family: Arial, sans-serif;
	  padding: 20px;
	  background-color: #ffe6f0;
	}
	
	/* 작성 페이지 폭을 화면 전체로 유지 */
	.login-container,
	#service-container {
	  width: calc(100% - 40px); /* body padding 20px씩 제외 */
	  margin: 0 auto;
	  background: #fff;
	  padding: 20px;
	  border-radius: 8px;
	}

	.danger-button {
	  color: red;
	  font-weight: bold;
	}
    
    /* 로그인 박스 디자인 */
    .login-container {
      max-width: 400px;
      padding: 30px;
      background-color: rgba(0, 0, 0, 0.6);
      /* 반투명 검정색 배경 */
      border-radius: 10px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
      text-align: center;
      color: white;
    }

	/* 🔒 제목, 버튼 고정 */
	.header-fixed {
	  position: sticky;
	  top: 0;
	  background-color: #ffffff;
	  z-index: 1000;
	  padding-top: 10px;
	  padding-bottom: 10px;
	}
	
	/* 🔒 테이블 헤더 고정용 래퍼 */
	.table-wrapper {
	  max-height: 600px;  /* 필요 시 조절 가능 */
	  overflow-y: auto;
	  background-color: #ffffff; 
	}
	
	/* 🔒 테이블 헤더(2줄) 고정 */
	#logTable thead tr:nth-child(1),
	#logTable thead tr:nth-child(2) {
	  position: sticky;
	  top: 0;
	  background-color: white;
	  z-index: 10;
	}

	  
    /* 타이틀 디자인 */
    .login-container h2 {
      color: #FF9800;
      /* 방송 시스템 색상, 주황색 */
      font-size: 24px;
      margin-bottom: 20px;
    }

    /* 인풋 박스 디자인 */
    .login-container input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #FF9800;
      /* 입력란 테두리 색상 주황색 */
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
      background-color: #333;
      /* 입력란 배경 어두운 색 */
      color: white;
    }

    .deleteAll {
  	background-color: #e91e63; /* 진한 핑크 */
	  color: white;
     }
	  
	#logTable select {
	  font-size: 16px;  /* 버튼과 동일하게 설정 */
  	  padding: 6px 12px;  /* 버튼과 여백도 맞춰주면 보기 좋음 */
	  font-weight: bold;   /* 굵기까지 맞추기 */
	  line-height: 1.4;
	}

.footer-button-container {
  text-align: center;
  margin-top: 30px;
  padding: 20px 0;
  border-top: 2px solid #ccc;
}

.footer-button-container button {
  padding: 12px 24px;
  margin: 5px;
  font-size: 16px;
  font-weight: bold;
  background-color: #607d8b;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.footer-button-container button:hover {
  background-color: #455a64;
}

    .footer-comment {
      margin-top: 15px;
      text-align: center;
      color: red;
      font-weight: bold;
      font-size: 16px;
     }

    /* 로그인 버튼 디자인 */
    .login-container button {
      width: 100%;
      padding: 12px;
      background-color: #FF9800;
      /* 버튼 색상 주황색 */
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
    }

    /* 버튼 호버 효과 */
    .login-container button:hover {
      background-color: #FF5722;
      /* 버튼 호버 시 색상 변경 (어두운 주황색) */
    }

    /* 오류 메시지 디자인 */
    .error-message {
      color: red;
      margin-top: 10px;
    }
  </style>

  <div id="dateCounts" style="margin-top: 20px;"></div>
  
  <!-- 실시간 서비스 페이지 -->
  <div id="service-container" style="display: none;">
    <h1 class="header-fixed">📡 6사보도 실시간 서비스</h1>
    <p id="currentUser" style="font-size: 18px; color: #333;">로그인된 사용자: </p> <!-- 로그인한 사용자 표시 -->
  <div class="button-container header-fixed">
      <button class="send" onclick="sendAlarm()">🔔 가청(요청)</button>
      <button class="stop" onclick="stopAlarm()">⏹ 가청정지(확인)</button>
      <button class="add" onclick="addRow()">➕ 행 추가</button>
      <button class="delete" onclick="deleteRow()">🗑 행 삭제</button>
      <button class="save" onclick="saveData()">💾 저장</button>
      <button id="refreshButton" class="refresh">🔃 새로고침</button>
      <button class="logout" onclick="logout()">로그아웃</button>
      <button onclick="downloadAsExcel()">📊 엑셀로 저장</button>
    </div>

<p id="viewStatus" style="text-align:center; font-weight:bold; margin-top: 10px;">📄 현재 보기: 기본 보기</p>

	  
    <audio id="alarmSound" loop>
      <source src="{{ url_for('static', filename='alarm.mp3') }}" type="audio/mpeg">
      브라우저가 오디오를 지원하지 않습니다.
    </audio>

<div class="table-wrapper">
    <table id="logTable">
      <thead>
        <tr>
	  <th rowspan="2">번호</th>
          <th rowspan="2">✔</th>
	  <th rowspan="2">송출구분</th>  <!-- ✅ 여기 추가 -->
          <th rowspan="2">날짜</th>
          <th rowspan="2">올린시간</th>
          <th rowspan="2">내용</th>
          <th rowspan="2">송출사</th>
          <th colspan="12">수신사</th>
        </tr>
<tr>
<th colspan="2"><img src="/static/sbs.png" class="logo-img" alt="SBS"></th>
<th colspan="2"><img src="/static/mbc.png" class="logo-img" alt="MBC"></th>
<th colspan="2"><img src="/static/kbs.png" class="logo-img" alt="KBS"></th>
<th colspan="2"><img src="/static/mbn.png" class="logo-img" alt="MBN"></th>
<th colspan="2"><img src="/static/ytn.png" class="logo-img" alt="YTN"></th>
<th colspan="2"><img src="/static/obs.png" class="logo-img" alt="OBS"></th>
</tr>

      </thead>
      <tbody id="tableBody"></tbody>
    </table>
</div>
    <div class="footer-button-container">
    <button onclick="loadTable()">📄 기본 보기</button>
    <button onclick="openAllRows()">📋 전체 행 보기</button>
    <button onclick="openAllView()">📊 이력 보기</button>
    <button class="deleteAll" onclick="deleteAllhides()">🗑 전체 행 숨김</button>
    <!-- <button class="danger-button" onclick="deleteAllRows()">❌ 전체 행 완전 삭제</button> -->
    </div>
  <div class="footer-comment">
  ⚠️ 처음 웹페이지 접속하시면, 새로고침 버튼을 한번 눌러주세요(그 이후로는 1분간격으로 자동 새로고침됩니다.)
  </div>

  </div>

  <style>

    #logTable {
	  width: 100%;
	  border-collapse: collapse;
	  margin-top: 20px;
	  background-color: #ffffff; 
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: center;
    }

    thead th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
	  
	tbody tr {
	  background-color: inherit;
	}

    td[contenteditable] {
      border: 1px solid #ccc;
    }
  </style>

<!-- ✅ 새롭게 닫힌 후 여기에 스타일 추가 -->
<style>
.logo-kbs {
  font-weight: bold;
  color: #00338D;
  font-size: 1.1rem;
  font-family: "Arial Black", sans-serif;
  letter-spacing: 1px;
}
.logo-mbc {
  font-weight: bold;
  color: #1c1c1c;
  font-size: 1.1rem;
  font-family: "Verdana", sans-serif;
}
.logo-sbs {
  font-weight: bold;
  color: #0a84ae;
  font-size: 1.1rem;
  font-family: "Tahoma", sans-serif;
}
.logo-mbn {
  font-weight: bold;
  color: #f37021;
}
.logo-ytn {
  font-weight: bold;
  color: #0066cc;
}
.logo-obs {
  font-weight: bold;
  color: #4caf50;
}
</style>
	
<style>
.logo-img {
  width: 60px;
  height: 24px;
  object-fit: contain;     /* 비율 유지하며 이미지 전체 보이기 */
  display: block;
  margin: auto;
  background-color: #f0f0f0; /* 이미지 깨졌을 때 배경 처리 */
}
</style>
<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>
