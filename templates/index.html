<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>ğŸ“¡ 6ì‚¬ë³´ë„ ì„œë¹„ìŠ¤ ë‚´ì—­</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "",
      authDomain: "sabodo-82fa8.firebaseapp.com",
      projectId: "sabodo-82fa8",
      storageBucket: "sabodo-82fa8.firebasestorage.app",
      messagingSenderId: "411843694800",
      appId: "1:411843694800:web:94e40d6ec9f05cdd60ced5",
      measurementId: "G-CKBERJMFMG"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const tableRef = db.collection("logTable");
    const alarmRef = db.collection("system").doc("alarmStatus"); // Firestoreì—ì„œ ì•ŒëŒ ìƒíƒœë¥¼ ê´€ë¦¬

    // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ í•¨ìˆ˜
    function checkLogin() {
      const currentUser = localStorage.getItem("username");
      if (currentUser) {
        document.getElementById("login-container").style.display = "none";
        document.getElementById("service-container").style.display = "block";
        document.getElementById("currentUser").innerText = `${currentUser} ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤! ì´ í˜ì´ì§€ëŠ” ì—˜ì§€ìœ í”ŒëŸ¬ìŠ¤ì—ì„œ ê´€ë¦¬ì¤‘ì…ë‹ˆë‹¤. ë¬¸ì˜ : 02-2089-0610`;  // ë¡œê·¸ì¸í•œ ê³„ì • í‘œì‹œ
        loadTable();
        listenToAlarmStatus(); // ì•ŒëŒ ìƒíƒœ ë¦¬ìŠ¤ë„ˆ ì‹œì‘
      } else {
        document.getElementById("login-container").style.display = "block";
        document.getElementById("service-container").style.display = "none";
      }
    }

function deleteAllhides() {
  tableRef
    .orderBy("createdAt", "desc")
    .get()
    .then(snapshot => {
      const docs = snapshot.docs;

      const hidePromises = [];
      for (let i = 0; i < docs.length; i++) {
        const data = docs[i].data();
        
        // ê³ ì • í–‰ ë‚´ìš©ê³¼ ê°™ì€ ê²½ìš° ì œì™¸
        if (data.content === "ğŸ›  ì´ê³³ì— ë‚´ìš©ì„ ì…ë ¥í•˜ì‹œë©´ ë‚ ì§œì™€ ì‹œê°„ì€ ìë™ìœ¼ë¡œ ì…ë ¥ë©ë‹ˆë‹¤.(ì²« í–‰ì€ ê³ ì •ìœ¼ë¡œ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.)") {
          continue; // ê³ ì • í–‰ì€ ìˆ¨ê¸°ì§€ ì•ŠìŒ
        }

        hidePromises.push(docs[i].ref.update({ hidden: true }));
      }

      Promise.all(hidePromises).then(() => {
        loadTable();
        alert("ëª¨ë“  í–‰ì„ ìˆ¨ê²¼ìŠµë‹ˆë‹¤ (ê³ ì • í–‰ì€ ìœ ì§€ë©ë‹ˆë‹¤).");
      });
    });
}

function toggleBroadcastStatus(button) {
  const tr = button.closest("tr");
  const rowId = tr.getAttribute("data-row-id");
  const current = button.innerText;

  let nextState, color;
  if (current === "ì†¡ì¶œì „") {
    nextState = "ì†¡ì¶œì¤‘";
    color = "#ffcccc";  // ì—°ë¹¨ê°•
  } else if (current === "ì†¡ì¶œì¤‘") {
    nextState = "ì†¡ì¶œí›„";
    color = "#dcdcdc";  // íšŒìƒ‰
  } else {
    nextState = "ì†¡ì¶œì „";
    color = "#fffbe6";  // ì—°ë…¸ë‘
  }

  // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë° í–‰ ìƒ‰ìƒ ë³€ê²½
  button.innerText = nextState;
  tr.style.backgroundColor = color;

  // Firestoreì— ìƒíƒœ ì—…ë°ì´íŠ¸
  if (rowId) {
    tableRef.doc(rowId).update({
      broadcastStatus: nextState
    });
  }
}


	  
function deleteAllRows() {
  if (!confirm("ì •ë§ ëª¨ë“  í–‰ì„ ì™„ì „íˆ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")) return;

  tableRef.get().then(snapshot => {
    const deletePromises = [];
    snapshot.forEach(doc => {
      const data = doc.data();

      // âœ… ê³ ì •í–‰ì€ ì‚­ì œí•˜ì§€ ì•ŠìŒ
      if (data.content === "ğŸ›  ì´ê³³ì— ë‚´ìš©ì„ ì…ë ¥í•˜ì‹œë©´ ë‚ ì§œì™€ ì‹œê°„ì€ ìë™ìœ¼ë¡œ ì…ë ¥ë©ë‹ˆë‹¤.(ì²« í–‰ì€ ê³ ì •ìœ¼ë¡œ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.)") {
        return; // ì‚­ì œ ì œì™¸
      }

      deletePromises.push(doc.ref.delete());
    });

    return Promise.all(deletePromises);
  }).then(() => {
    alert("ëª¨ë“  í–‰ì´ ì™„ì „íˆ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤ (ê³ ì • í–‰ ì œì™¸).");
    loadTable();
  }).catch(error => {
    console.error("ì‚­ì œ ì˜¤ë¥˜:", error);
    alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  });
}



  // ê±´ìˆ˜ ë³´ê¸° í•¨ìˆ˜
  function openAllView() {
    window.open("allview.html", "_blank", "width=1200,height=800");
  }

// ì „ì²´ ë³´ê¸° í•¨ìˆ˜
function openAllRows() {
    // hidden ì—¬ë¶€ì— ê´€ê³„ì—†ì´ ì „ì²´ ë¡œìš° ë³´ì—¬ì£¼ê¸°
    tableRef
      .orderBy('createdAt', 'desc')
      .get()
      .then(snapshot => {
        const tbody = document.getElementById("tableBody");
        tbody.innerHTML = "";
        const docs = snapshot.docs;
        const total = docs.length;

        docs.forEach((doc, index) => {
          const data = doc.data();
          const rowId = doc.id;
          const tr = document.createElement("tr");
          tr.setAttribute("data-row-id", rowId);
          tr.innerHTML = `
            <td>${total - index}</td>
	    <td><input type="checkbox" data-id="${rowId}" /></td>
            <td>${data.date || ''}</td>
            <td>${data.time || ''}</td>
            <td>${data.content || ''}</td>
            <td>${data.sender || ''}</td>
            <td colspan="6">ìˆ¨ê¹€ ì—¬ë¶€: ${data.hidden ? 'âœ… ìˆ¨ê¹€' : 'âŒ í‘œì‹œì¤‘'}</td>
          `;
          tbody.appendChild(tr);
        });
      });
	document.getElementById("viewStatus").innerText = "ğŸ“‹ í˜„ì¬ ë³´ê¸°: ì „ì²´ í–‰ ë³´ê¸°";

  }

function downloadAsExcel() {
  const table = document.getElementById("logTable");
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.table_to_sheet(table);
  XLSX.utils.book_append_sheet(wb, ws, "6ì‚¬ë³´ë„ë§");

  // âœ… ì˜¤ëŠ˜ ë‚ ì§œ êµ¬í•˜ê¸° (YYYY-MM-DD í˜•ì‹)
  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = String(now.getMonth() + 1).padStart(2, '0');
  const dd = String(now.getDate()).padStart(2, '0');
  const todayStr = `${yyyy}-${mm}-${dd}`;

  // âœ… íŒŒì¼ëª…ì— ë‚ ì§œ ì¶”ê°€
  XLSX.writeFile(wb, `6ì‚¬ë³´ë„ë§_ì„œë¹„ìŠ¤ë‚´ì—­_${todayStr}.xlsx`);
}


    // ë¡œê·¸ì¸ í•¨ìˆ˜
    function login() {
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;
      const validUsers = {
        "lgu+": "lgu+",
        "kbs": "kbs",
        "mbc": "mbc",
        "sbs": "sbs",
        "ytn": "ytn",
        "mbn": "mbn",
        "obs": "obs"
      };

      if (validUsers[username] && validUsers[username] === password) {
        localStorage.setItem("username", username);
        checkLogin();
      } else {
        document.getElementById("error-message").innerText = "ì•„ì´ë””ë‚˜ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.";
      }
    }


    // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
    function logout() {
      localStorage.removeItem("username");
      checkLogin();
    }

    /**
 * ë‚´ìš© ì…€ ìˆ˜ì • í›„ í˜¸ì¶œë©ë‹ˆë‹¤.
 * @param {string} id    - Firestore ë¬¸ì„œ ID
 * @param {string} text  - ì…ë ¥ëœ ë‚´ìš©
 */
function onContentChange(id, text) {
  // ë‚´ìš©ì´ ë¹„ì–´ìˆìœ¼ë©´ ì•„ë¬´ ê²ƒë„ ì•ˆ í•¨
  if (!text.trim()) return;

  const now = new Date();
  // YYYY-MM-DD í¬ë§·
  const date = [
    now.getFullYear(),
    String(now.getMonth() + 1).padStart(2, '0'),
    String(now.getDate()).padStart(2, '0')
  ].join('-');
  // HH:MM:SS í¬ë§·
  const time = [
    String(now.getHours()).padStart(2, '0'),
    String(now.getMinutes()).padStart(2, '0'),
    String(now.getSeconds()).padStart(2, '0')
  ].join(':');

  // Firestoreì— í•œêº¼ë²ˆì— ì—…ë°ì´íŠ¸
  tableRef.doc(id).update({
    content: text,
    date: date,
    time: time
  }).then(() => {
    loadTable();  // UI ìƒˆë¡œê³ ì¹¨
  });
}


    
    // ì•ŒëŒ ìƒíƒœ ë¦¬ìŠ¤ë„ˆ
    function listenToAlarmStatus() {
      alarmRef.onSnapshot(doc => {
        const alarmStatus = doc.data();
        if (alarmStatus && alarmStatus.isAlarmActive) {
          document.getElementById("alarmSound").play(); // ì•ŒëŒ ìš¸ë¦¬ê¸°
        } else {
          document.getElementById("alarmSound").pause(); // ì•ŒëŒ ì •ì§€
          document.getElementById("alarmSound").currentTime = 0;
        }
      });
    }

    // ì•ŒëŒ ì‹œì‘ í•¨ìˆ˜
    function sendAlarm() {
      alarmRef.set({isAlarmActive: true}).then(() => {
        console.log("ì•ŒëŒì´ ìš¸ë ¸ìŠµë‹ˆë‹¤.");
      });
    }

    // ì•ŒëŒ ì •ì§€ í•¨ìˆ˜
    function stopAlarm() {
      alarmRef.set({isAlarmActive: false}).then(() => {
        console.log("ì•ŒëŒì´ ì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.");
      });
    }

    // ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
    function loadTable() {
      const dateCounts = {}; // ì´ ì¤„ì„ loadTable() í•¨ìˆ˜ ë§¨ ìœ„ì— ì¶”ê°€
      const currentUser = localStorage.getItem("username"); // ë¡œê·¸ì¸ëœ ì‚¬ìš©ì
      const receivers = ["KBS", "MBC", "SBS", "MBN", "YTN", "OBS"];

	tableRef
    	.orderBy('createdAt','desc')   // ìƒì„±ëœ ìˆœì„œ(ì˜¤ë˜ëœ ê²ƒë¶€í„°)ë¡œ ì •ë ¬
  	  .get()
  	  .then(snapshot => {
	const docs = snapshot.docs.filter(doc => !doc.data().hidden); // hiddenì´ trueì¸ ë¬¸ì„œ ì œì™¸
        const tbody = document.getElementById("tableBody");
        tbody.innerHTML = ""; // í…Œì´ë¸” ì´ˆê¸°í™”

    const total = docs.length;  // âœ… ìˆ˜ì •: ì „ì²´ ë¬¸ì„œ ìˆ˜ê°€ ì•„ë‹Œ í•„í„°ë§ëœ ë¬¸ì„œ ìˆ˜ë¡œ
    docs.forEach((doc, index) => {
      const data = doc.data();
      const rowId = doc.id;

          const tr = document.createElement("tr");
          tr.setAttribute("data-row-id", rowId);  // í–‰ IDë¥¼ data-row-idë¡œ ì„¤ì •

	// âœ… ìƒíƒœì— ë”°ë¼ ë°°ê²½ìƒ‰ ì§€ì •
	const status = data.broadcastStatus || "ì†¡ì¶œì „";
	let bgColor = "#fffbe6"; // ê¸°ë³¸ ì†¡ì¶œì „
	if (status === "ì†¡ì¶œì¤‘") bgColor = "#ffcccc";
	else if (status === "ì†¡ì¶œí›„") bgColor = "#dcdcdc";
	tr.style.backgroundColor = bgColor;


          // ìˆ˜ì‹ ì‚¬ë³„ë¡œ ì œì™¸ ìƒíƒœë¥¼ ì²´í¬í•˜ì—¬, í•´ë‹¹ ìˆ˜ì‹ ì‚¬ì—ì„œ ì œì™¸ëœ í–‰ë§Œ ìˆ¨ê¹€
          let shouldDisplayRow = true;

          receivers.forEach((name, idx) => {
            // ë¡œê·¸ì¸ëœ ê³„ì •ì´ í•´ë‹¹ ìˆ˜ì‹ ì‚¬ì¼ ê²½ìš°, ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ë¹„êµ
            if (currentUser.toUpperCase() === name.toUpperCase() && data[name] && data[name].exclude === "ë¯¸ìˆ˜ì‹ ") {
              shouldDisplayRow = false;  // í•´ë‹¹ ìˆ˜ì‹ ì‚¬ì—ì„œ ì œì™¸ëœ ê²½ìš° í•´ë‹¹ í–‰ì„ ìˆ¨ê¸°ë„ë¡ ì„¤ì •
            }
          });

          // í–‰ì„ ìˆ¨ê¸°ì§€ ì•Šë„ë¡ ì„¤ì •
          if (!shouldDisplayRow) {
            tr.style.display = "none";  // í•´ë‹¹ ìˆ˜ì‹ ì‚¬ì—ì„œ ì œì™¸ëœ ê²½ìš° í•´ë‹¹ í–‰ì„ ìˆ¨ê¹€
          }

          tr.innerHTML = `
  	    <td>${total - index}</td>  <!-- âœ… ì—­ìˆœ ë²ˆí˜¸ í‘œì‹œ -->
	    <td><input type="checkbox" data-id="${rowId}" /></td>
	    <td><button onclick="toggleBroadcastStatus(this)">${status}</button></td>
            <td contenteditable="true" onblur="updateCell('${doc.id}', 'date', this.innerText)">${data.date || ''}</td>
            <td contenteditable="true" onblur="updateCell('${doc.id}', 'time', this.innerText)">${data.time || ''}</td>
            <td contenteditable="true" onblur="onContentChange('${doc.id}', this.innerText)">${data.content || ''}</td>
		<td>
  		<select onchange="updateCell('${doc.id}', 'sender', this.value)">
   		 ${["ì„ íƒ","LGU+", "KBS", "MBC", "SBS", "YTN", "MBN", "OBS"].map(option => `
   		   <option value="${option}" ${data.sender === option ? 'selected' : ''}>${option}</option>
  		  `).join('')}
 		 </select>
		</td>

${receivers.map(rcv => `
  <td>
    <button class="logo-${rcv.toLowerCase()}" onclick="toggleAck('${doc.id}', '${rcv}')">
      ${(data[rcv] && data[rcv].ack) || 'í™•ì¸!'}
    </button>
  </td>
  <td>
    <button onclick="toggleExclude(this, '${doc.id}', '${rcv}')" 
            class="${(data[rcv] && data[rcv].exclude === 'ë¯¸ìˆ˜ì‹ ') ? 'exclude-btn active' : 'exclude-btn'}">
      ${(data[rcv] && data[rcv].exclude) || 'ìˆ˜ì‹ '}
    </button>
  </td>
`).join('')}

          `;
          tbody.appendChild(tr);
          // â­ ë‚ ì§œë³„ ê±´ìˆ˜ ì„¸ê¸°
          if (data.date) {
            if (dateCounts[data.date]) {
              dateCounts[data.date]++;
            } else {
              dateCounts[data.date] = 1;
            }
          }

        index++;  // âœ… ì¹´ìš´í„° ì¦ê°€
        });
		  		  // ê³ ì •ëœ ì²« í–‰ ì¶”ê°€
		const fixedRow = document.createElement("tr");
		fixedRow.innerHTML = `
		  <td>ê³ ì •</td>
		  <td></td>
		  <td></td>
		  <td>2025-xx-xx</td>
		  <td>00:00:00</td>
		  <td>ğŸ›  ì´ê³³ì— ë‚´ìš©ì„ ì…ë ¥í•˜ì‹œë©´ ë‚ ì§œì™€ ì‹œê°„ì€ ìë™ìœ¼ë¡œ ì…ë ¥ë©ë‹ˆë‹¤.(ì²« í–‰ì€ ê³ ì •ìœ¼ë¡œ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.)</td>
		  <td>LGU+</td>
		  <td colspan="12" style="color:blue;">ìˆ˜ì‹ ì‚¬ì—ì„œëŠ” ë‚´ìš© í™•ì¸ ì‹œ í™•ì¸ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</td>
		`;
    		tbody.appendChild(fixedRow);
      });
	    document.getElementById("viewStatus").innerText = "ğŸ“„ í˜„ì¬ ë³´ê¸°: ê¸°ë³¸ ë³´ê¸°";
    }

    // ì…€ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateCell(id, field, value) {
      tableRef.doc(id).update({[field]: value}).then(() => loadTable());
    }

    // í™•ì¸ ìƒíƒœ í† ê¸€
    function toggleAck(id, rcv) {
      const cellRef = tableRef.doc(id);
      cellRef.get().then(doc => {
        const data = doc.data();
        const current = (data[rcv] && data[rcv].ack) || 'í™•ì¸!';
        const updated = current === 'í™•ì¸!' ? 'âœ… í™•ì¸ë¨' : 'í™•ì¸!';
        cellRef.update({[`${rcv}.ack`]: updated}).then(() => {
          loadTable();
        });
      });
    }

    // ì œì™¸ ìƒíƒœ í† ê¸€ (í•´ë‹¹ ê³„ì •ì—ë§Œ ì ìš©)
    function toggleExclude(btn, id, rcv) {
      const currentUser = localStorage.getItem("username");
      const cellRef = tableRef.doc(id);

      // Firestoreì—ì„œ í•´ë‹¹ í–‰ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
      cellRef.get().then(doc => {
        const data = doc.data();

        // í˜„ì¬ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
        const current = (data[rcv] && data[rcv].exclude) || 'ìˆ˜ì‹ ';

        // ìƒˆë¡œìš´ ì œì™¸ ìƒíƒœ
        const updated = current === 'ìˆ˜ì‹ ' ? 'ë¯¸ìˆ˜ì‹ ' : 'ìˆ˜ì‹ ';

        // ì œì™¸ ìƒíƒœë¥¼ Firestoreì— ì—…ë°ì´íŠ¸ (í˜„ì¬ ê³„ì •ì— ëŒ€í•´ì„œë§Œ)
        cellRef.update({
          [`${rcv}.exclude`]: updated,
          [`${rcv}.ack`]: 'í™•ì¸!'  // í™•ì¸ ìƒíƒœ ì´ˆê¸°í™”
        }).then(() => {
          // ì¦‰ì‹œ ë°˜ì˜
          loadTable();

          // ë²„íŠ¼ ìƒ‰ ë³€ê²½: ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œ
          btn.classList.toggle('active');
        });
      });
    }

    // í–‰ ì¶”ê°€ í•¨ìˆ˜
    function addRow() {
      const rowData = {
        date: '', time: '', content: '', sender: '',
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
	hidden: false,  // âœ… ìˆ¨ê¹€ ì—¬ë¶€
  	broadcastStatus: "ì†¡ì¶œì „",  // âœ… ë²„íŠ¼ ìƒíƒœ ê¸°ë³¸ê°’
      };

      const receivers = ["KBS", "MBC", "SBS", "MBN", "YTN", "OBS"];
      receivers.forEach(rcv => {
        rowData[rcv] = {ack: 'í™•ì¸!', exclude: 'ìˆ˜ì‹ '};
      });
      tableRef.add(rowData).then(() => {
        loadTable();
      });
    }

    function saveData() {
      alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
    }


    // í–‰ ìˆ¨ê¸°ê¸° í•¨ìˆ˜
function deleteRow() {
  const checkedBoxes = document.querySelectorAll("#logTable tbody input[type='checkbox']:checked");
  const deletePromises = [];

  checkedBoxes.forEach(box => {
    const id = box.getAttribute("data-id");
    const row = box.closest("tr");
    const isFixedRow = row && row.innerText.includes("ğŸ›  ì´ê³³ì— ë‚´ìš©ì„ ì…ë ¥í•˜ì‹œë©´");

    if (!isFixedRow && id) {
      deletePromises.push(tableRef.doc(id).delete());
    }
  });

  Promise.all(deletePromises).then(() => {
    loadTable();
  });
}


    // í˜ì´ì§€ ë¡œë”© ì‹œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
    document.addEventListener("DOMContentLoaded", checkLogin);

    // ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ í´ë¦­ ì‹œ í˜ì´ì§€ ë¦¬í”„ë ˆì‹œ
    document.addEventListener("DOMContentLoaded", function () {
      const refreshButton = document.getElementById("refreshButton");
      if (refreshButton) {
        refreshButton.addEventListener("click", function () {
          window.location.reload(); // í˜ì´ì§€ ë¦¬í”„ë ˆì‹œ
        });
      }
    });

    // 1ë¶„ë§ˆë‹¤ ìë™ìœ¼ë¡œ í˜ì´ì§€ ë¦¬í”„ë ˆì‹œ
    setInterval(function () {
      window.location.reload(); // í˜ì´ì§€ ë¦¬í”„ë ˆì‹œ
    }, 300000); // 60000ms = 1ë¶„
  </script>
  <style>

    h1 {
      text-align: center;
    }

    .button-container {
      text-align: center;
      margin-bottom: 20px;
    }

    button {
      padding: 12px 24px;
      font-size: 16px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    .send,
    .stop,
    .add,
    .delete,
    .save,
    .refresh,
    .logout {
      background-color: #2196F3;
      color: white;
    }

    .send {
      background-color: #FF9800;
    }

    .stop {
      background-color: #f44336;
    }

    .add,
    .delete,
    .save {
      background-color: #4CAF50;
    }

    .exclude-btn.active {
      background-color: #f44336;
      color: white;
    }

    .exclude-btn {
      background-color: #2196F3;
      color: white;
    }

    /* ëª¨ë“  í…Œì´ë¸” ë²„íŠ¼ í¬ê¸° ì¶•ì†Œ */
#logTable td button {
  padding: 6px 12px;
  font-size: 1rem;
  line-height: 1.4;
  min-width: 0;          /* ìµœì†Œ ë„ˆë¹„ ì œí•œ í•´ì œ */
}

    /* â€˜ë‚´ìš©â€™ ì…ë ¥ ì¹¼ëŸ¼(í…Œì´ë¸” 6ë²ˆì§¸ ì¹¼ëŸ¼) ê¸€ì í¬ê²Œ */
#logTable td:nth-child(6),
#logTable th:nth-child(6) {
  font-size: 1.2rem;    /* ì›í•˜ì‹œëŠ” í¬ê¸°ë¡œ ì¡°ì •í•˜ì„¸ìš” */
  line-height: 1.4;     /* í•„ìš”ì‹œ ì¤„ê°„ê²©ë„ ì¡°ì ˆ */
}

    .logout {
      background-color: #9C27B0;
    }

    .login-container {
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .login-container input {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .login-container button {
      width: 100%;
      padding: 12px;
      background-color: #2196F3;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .login-container button:hover {
      background-color: #1976D2;
    }

    .error-message {
      color: red;
      margin-top: 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: center;
    }

    thead th {
      background-color: #f2f2f2;
      font-weight: bold;
    }


    td[contenteditable] {
      border: 1px solid #ccc;
    }

    .receiver-row {
      text-align: center;
      font-weight: bold;
      background-color: #f2f2f2;
    }
  </style>
 <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
  <!-- ë¡œê·¸ì¸ í˜ì´ì§€ -->
  <div id="login-container" class="login-container">
    <h2>ğŸ“¡ 6ì‚¬ë³´ë„ë§ ë¡œê·¸ì¸</h2>
    <input type="text" id="username" placeholder="ì•„ì´ë””" required />
    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸" required />
    <button onclick="login()">ë¡œê·¸ì¸</button>
    <div class="error-message" id="error-message"></div> <!-- ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ -->
  </div>


  <style>

	/* í˜ì´ì§€ ì „ë°˜ ë°°ê²½ì„ ì˜…ì€ ë¶„í™ìƒ‰ìœ¼ë¡œ ì„¤ì • */
	body {
	  font-family: Arial, sans-serif;
	  padding: 20px;
	  background-color: #ffe6f0;
	}
	
	/* ì‘ì„± í˜ì´ì§€ í­ì„ í™”ë©´ ì „ì²´ë¡œ ìœ ì§€ */
	.login-container,
	#service-container {
	  width: calc(100% - 40px); /* body padding 20pxì”© ì œì™¸ */
	  margin: 0 auto;
	  background: #fff;
	  padding: 20px;
	  border-radius: 8px;
	}

	.danger-button {
	  color: red;
	  font-weight: bold;
	}
    
    /* ë¡œê·¸ì¸ ë°•ìŠ¤ ë””ìì¸ */
    .login-container {
      max-width: 400px;
      padding: 30px;
      background-color: rgba(0, 0, 0, 0.6);
      /* ë°˜íˆ¬ëª… ê²€ì •ìƒ‰ ë°°ê²½ */
      border-radius: 10px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
      text-align: center;
      color: white;
    }

	/* ğŸ”’ ì œëª©, ë²„íŠ¼ ê³ ì • */
	.header-fixed {
	  position: sticky;
	  top: 0;
	  background-color: #ffffff;
	  z-index: 1000;
	  padding-top: 10px;
	  padding-bottom: 10px;
	}
	
	/* ğŸ”’ í…Œì´ë¸” í—¤ë” ê³ ì •ìš© ë˜í¼ */
	.table-wrapper {
	  max-height: 600px;  /* í•„ìš” ì‹œ ì¡°ì ˆ ê°€ëŠ¥ */
	  overflow-y: auto;
	  background-color: #ffffff; 
	}
	
	/* ğŸ”’ í…Œì´ë¸” í—¤ë”(2ì¤„) ê³ ì • */
	#logTable thead tr:nth-child(1),
	#logTable thead tr:nth-child(2) {
	  position: sticky;
	  top: 0;
	  background-color: white;
	  z-index: 10;
	}

	  
    /* íƒ€ì´í‹€ ë””ìì¸ */
    .login-container h2 {
      color: #FF9800;
      /* ë°©ì†¡ ì‹œìŠ¤í…œ ìƒ‰ìƒ, ì£¼í™©ìƒ‰ */
      font-size: 24px;
      margin-bottom: 20px;
    }

    /* ì¸í’‹ ë°•ìŠ¤ ë””ìì¸ */
    .login-container input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #FF9800;
      /* ì…ë ¥ë€ í…Œë‘ë¦¬ ìƒ‰ìƒ ì£¼í™©ìƒ‰ */
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
      background-color: #333;
      /* ì…ë ¥ë€ ë°°ê²½ ì–´ë‘ìš´ ìƒ‰ */
      color: white;
    }

    .deleteAll {
  	background-color: #e91e63; /* ì§„í•œ í•‘í¬ */
	  color: white;
     }
	  
	#logTable select {
	  font-size: 16px;  /* ë²„íŠ¼ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì • */
  	  padding: 6px 12px;  /* ë²„íŠ¼ê³¼ ì—¬ë°±ë„ ë§ì¶°ì£¼ë©´ ë³´ê¸° ì¢‹ìŒ */
	  font-weight: bold;   /* êµµê¸°ê¹Œì§€ ë§ì¶”ê¸° */
	  line-height: 1.4;
	}

.footer-button-container {
  text-align: center;
  margin-top: 30px;
  padding: 20px 0;
  border-top: 2px solid #ccc;
}

.footer-button-container button {
  padding: 12px 24px;
  margin: 5px;
  font-size: 16px;
  font-weight: bold;
  background-color: #607d8b;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.footer-button-container button:hover {
  background-color: #455a64;
}

    .footer-comment {
      margin-top: 15px;
      text-align: center;
      color: red;
      font-weight: bold;
      font-size: 16px;
     }

    /* ë¡œê·¸ì¸ ë²„íŠ¼ ë””ìì¸ */
    .login-container button {
      width: 100%;
      padding: 12px;
      background-color: #FF9800;
      /* ë²„íŠ¼ ìƒ‰ìƒ ì£¼í™©ìƒ‰ */
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
    }

    /* ë²„íŠ¼ í˜¸ë²„ íš¨ê³¼ */
    .login-container button:hover {
      background-color: #FF5722;
      /* ë²„íŠ¼ í˜¸ë²„ ì‹œ ìƒ‰ìƒ ë³€ê²½ (ì–´ë‘ìš´ ì£¼í™©ìƒ‰) */
    }

    /* ì˜¤ë¥˜ ë©”ì‹œì§€ ë””ìì¸ */
    .error-message {
      color: red;
      margin-top: 10px;
    }
  </style>

  <div id="dateCounts" style="margin-top: 20px;"></div>
  
  <!-- ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤ í˜ì´ì§€ -->
  <div id="service-container" style="display: none;">
    <h1 class="header-fixed">ğŸ“¡ 6ì‚¬ë³´ë„ ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤</h1>
    <p id="currentUser" style="font-size: 18px; color: #333;">ë¡œê·¸ì¸ëœ ì‚¬ìš©ì: </p> <!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ì í‘œì‹œ -->
  <div class="button-container header-fixed">
      <button class="send" onclick="sendAlarm()">ğŸ”” ê°€ì²­(ìš”ì²­)</button>
      <button class="stop" onclick="stopAlarm()">â¹ ê°€ì²­ì •ì§€(í™•ì¸)</button>
      <button class="add" onclick="addRow()">â• í–‰ ì¶”ê°€</button>
      <button class="delete" onclick="deleteRow()">ğŸ—‘ í–‰ ì‚­ì œ</button>
      <button class="save" onclick="saveData()">ğŸ’¾ ì €ì¥</button>
      <button id="refreshButton" class="refresh">ğŸ”ƒ ìƒˆë¡œê³ ì¹¨</button>
      <button class="logout" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
      <button onclick="downloadAsExcel()">ğŸ“Š ì—‘ì…€ë¡œ ì €ì¥</button>
    </div>

<p id="viewStatus" style="text-align:center; font-weight:bold; margin-top: 10px;">ğŸ“„ í˜„ì¬ ë³´ê¸°: ê¸°ë³¸ ë³´ê¸°</p>

	  
    <audio id="alarmSound" loop>
      <source src="{{ url_for('static', filename='alarm.mp3') }}" type="audio/mpeg">
      ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    </audio>

<div class="table-wrapper">
    <table id="logTable">
      <thead>
        <tr>
	  <th rowspan="2">ë²ˆí˜¸</th>
          <th rowspan="2">âœ”</th>
	  <th rowspan="2">ì†¡ì¶œêµ¬ë¶„</th>  <!-- âœ… ì—¬ê¸° ì¶”ê°€ -->
          <th rowspan="2">ë‚ ì§œ</th>
          <th rowspan="2">ì˜¬ë¦°ì‹œê°„</th>
          <th rowspan="2">ë‚´ìš©</th>
          <th rowspan="2">ì†¡ì¶œì‚¬</th>
          <th colspan="12">ìˆ˜ì‹ ì‚¬</th>
        </tr>
<tr>
<th colspan="2"><img src="/static/sbs.png" class="logo-img" alt="SBS"></th>
<th colspan="2"><img src="/static/mbc.png" class="logo-img" alt="MBC"></th>
<th colspan="2"><img src="/static/kbs.png" class="logo-img" alt="KBS"></th>
<th colspan="2"><img src="/static/mbn.png" class="logo-img" alt="MBN"></th>
<th colspan="2"><img src="/static/ytn.png" class="logo-img" alt="YTN"></th>
<th colspan="2"><img src="/static/obs.png" class="logo-img" alt="OBS"></th>
</tr>

      </thead>
      <tbody id="tableBody"></tbody>
    </table>
</div>
    <div class="footer-button-container">
    <button onclick="loadTable()">ğŸ“„ ê¸°ë³¸ ë³´ê¸°</button>
    <button onclick="openAllRows()">ğŸ“‹ ì „ì²´ í–‰ ë³´ê¸°</button>
    <button onclick="openAllView()">ğŸ“Š ì´ë ¥ ë³´ê¸°</button>
    <button class="deleteAll" onclick="deleteAllhides()">ğŸ—‘ ì „ì²´ í–‰ ìˆ¨ê¹€</button>
    <!-- <button class="danger-button" onclick="deleteAllRows()">âŒ ì „ì²´ í–‰ ì™„ì „ ì‚­ì œ</button> -->
    </div>
  <div class="footer-comment">
  âš ï¸ ì²˜ìŒ ì›¹í˜ì´ì§€ ì ‘ì†í•˜ì‹œë©´, ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ì„ í•œë²ˆ ëˆŒëŸ¬ì£¼ì„¸ìš”(ê·¸ ì´í›„ë¡œëŠ” 1ë¶„ê°„ê²©ìœ¼ë¡œ ìë™ ìƒˆë¡œê³ ì¹¨ë©ë‹ˆë‹¤.)
  </div>

  </div>

  <style>

    #logTable {
	  width: 100%;
	  border-collapse: collapse;
	  margin-top: 20px;
	  background-color: #ffffff; 
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 12px;
      text-align: center;
    }

    thead th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
	  
	tbody tr {
	  background-color: inherit;
	}

    td[contenteditable] {
      border: 1px solid #ccc;
    }
  </style>

<!-- âœ… ìƒˆë¡­ê²Œ ë‹«íŒ í›„ ì—¬ê¸°ì— ìŠ¤íƒ€ì¼ ì¶”ê°€ -->
<style>
.logo-kbs {
  font-weight: bold;
  color: #00338D;
  font-size: 1.1rem;
  font-family: "Arial Black", sans-serif;
  letter-spacing: 1px;
}
.logo-mbc {
  font-weight: bold;
  color: #1c1c1c;
  font-size: 1.1rem;
  font-family: "Verdana", sans-serif;
}
.logo-sbs {
  font-weight: bold;
  color: #0a84ae;
  font-size: 1.1rem;
  font-family: "Tahoma", sans-serif;
}
.logo-mbn {
  font-weight: bold;
  color: #f37021;
}
.logo-ytn {
  font-weight: bold;
  color: #0066cc;
}
.logo-obs {
  font-weight: bold;
  color: #4caf50;
}
</style>
	
<style>
.logo-img {
  width: 60px;
  height: 24px;
  object-fit: contain;     /* ë¹„ìœ¨ ìœ ì§€í•˜ë©° ì´ë¯¸ì§€ ì „ì²´ ë³´ì´ê¸° */
  display: block;
  margin: auto;
  background-color: #f0f0f0; /* ì´ë¯¸ì§€ ê¹¨ì¡Œì„ ë•Œ ë°°ê²½ ì²˜ë¦¬ */
}
</style>
<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>
